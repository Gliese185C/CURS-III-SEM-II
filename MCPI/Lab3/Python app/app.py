# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'lab3.ui'
#
# Created by: PyQt5 UI code generator 5.15.4
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui, QtWidgets
import pleifer


class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.resize(1300, 800)
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.textInput = QtWidgets.QPlainTextEdit(self.centralwidget)
        self.textInput.setGeometry(QtCore.QRect(10, 10, 821, 331))
        font = QtGui.QFont()
        font.setPointSize(12)
        self.textInput.setFont(font)
        self.textInput.setObjectName("textInput")
        self.textOutput = QtWidgets.QPlainTextEdit(self.centralwidget)
        self.textOutput.setGeometry(QtCore.QRect(10, 460, 821, 331))
        font = QtGui.QFont()
        font.setPointSize(12)
        self.textOutput.setFont(font)
        self.textOutput.setObjectName("textOutput")
        self.textLog = QtWidgets.QPlainTextEdit(self.centralwidget)
        self.textLog.setGeometry(QtCore.QRect(840, 10, 451, 781))
        font = QtGui.QFont()
        font.setPointSize(12)
        self.textLog.setFont(font)
        self.textLog.setReadOnly(True)
        self.textLog.setObjectName("textLog")
        self.buttonEncrypt = QtWidgets.QPushButton(self.centralwidget)
        self.buttonEncrypt.setGeometry(QtCore.QRect(10, 370, 141, 61))
        font = QtGui.QFont()
        font.setPointSize(12)
        self.buttonEncrypt.setFont(font)
        self.buttonEncrypt.setObjectName("buttonEncrypt")
        self.buttonDecrypt = QtWidgets.QPushButton(self.centralwidget)
        self.buttonDecrypt.setGeometry(QtCore.QRect(690, 370, 141, 61))
        font = QtGui.QFont()
        font.setPointSize(12)
        self.buttonDecrypt.setFont(font)
        self.buttonDecrypt.setObjectName("buttonDecrypt")
        self.textKey = QtWidgets.QPlainTextEdit(self.centralwidget)
        self.textKey.setGeometry(QtCore.QRect(170, 370, 241, 61))
        font = QtGui.QFont()
        font.setPointSize(12)
        self.textKey.setFont(font)
        self.textKey.setObjectName("textKey")
        self.comboBox = QtWidgets.QComboBox(self.centralwidget)
        self.comboBox.setGeometry(QtCore.QRect(520, 410, 69, 22))
        font = QtGui.QFont()
        font.setPointSize(12)
        self.comboBox.setFont(font)
        self.comboBox.setObjectName("comboBox")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.label = QtWidgets.QLabel(self.centralwidget)
        self.label.setGeometry(QtCore.QRect(490, 376, 161, 21))
        font = QtGui.QFont()
        font.setPointSize(11)
        self.label.setFont(font)
        self.label.setObjectName("label")
        MainWindow.setCentralWidget(self.centralwidget)

        self.retranslateUi(MainWindow)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

        self.pleifer = pleifer.Pleifer()

        self.buttonEncrypt.clicked.connect(lambda : self.encrypt(1))
        self.buttonDecrypt.clicked.connect(lambda : self.encrypt(-1))


    def encrypt(self,mode):
        message = self.textInput.toPlainText()
        key = self.textKey.toPlainText()
        letter = self.comboBox.currentText()
        print(message,key,letter,mode)
        response = self.pleifer.encrypt(message,key,letter,mode)
        if not response["response"]["process"]:
            self.error(response["response"]["error"])
        else:
            self.textOutput.setPlainText(response["context"])
            with open("log.txt","r",encoding='utf-8') as file:
                self.textLog.setPlainText(file.read())

    def error(self,error):
        tmp = QtWidgets.QMessageBox()
        tmp.setIcon(QtWidgets.QMessageBox.Critical)
        tmp.setWindowTitle("Incorrect validation")
        tmp.setText(error)
        tmp.exec_()

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "MainWindow"))
        self.textInput.setPlaceholderText(_translate("MainWindow", "Write a message to encrypt / decrypt here"))
        self.buttonEncrypt.setText(_translate("MainWindow", "Encrypt"))
        self.buttonDecrypt.setText(_translate("MainWindow", "Decrypt"))
        self.textKey.setPlaceholderText(_translate("MainWindow", "Write key here"))
        self.comboBox.setItemText(0, _translate("MainWindow", "А"))
        self.comboBox.setItemText(1, _translate("MainWindow", "Б"))
        self.comboBox.setItemText(2, _translate("MainWindow", "В"))
        self.comboBox.setItemText(3, _translate("MainWindow", "Г"))
        self.comboBox.setItemText(4, _translate("MainWindow", "Д"))
        self.comboBox.setItemText(5, _translate("MainWindow", "Е"))
        self.comboBox.setItemText(6, _translate("MainWindow", "Ё"))
        self.comboBox.setItemText(7, _translate("MainWindow", "Ж"))
        self.comboBox.setItemText(8, _translate("MainWindow", "З"))
        self.comboBox.setItemText(9, _translate("MainWindow", "И"))
        self.comboBox.setItemText(10, _translate("MainWindow", "Й"))
        self.comboBox.setItemText(11, _translate("MainWindow", "К"))
        self.comboBox.setItemText(12, _translate("MainWindow", "Л"))
        self.comboBox.setItemText(13, _translate("MainWindow", "М"))
        self.comboBox.setItemText(14, _translate("MainWindow", "Н"))
        self.comboBox.setItemText(15, _translate("MainWindow", "О"))
        self.comboBox.setItemText(16, _translate("MainWindow", "П"))
        self.comboBox.setItemText(17, _translate("MainWindow", "Р"))
        self.comboBox.setItemText(18, _translate("MainWindow", "С"))
        self.comboBox.setItemText(19, _translate("MainWindow", "Т"))
        self.comboBox.setItemText(20, _translate("MainWindow", "У"))
        self.comboBox.setItemText(21, _translate("MainWindow", "Ф"))
        self.comboBox.setItemText(22, _translate("MainWindow", "Х"))
        self.comboBox.setItemText(23, _translate("MainWindow", "Ц"))
        self.comboBox.setItemText(24, _translate("MainWindow", "Ч"))
        self.comboBox.setItemText(25, _translate("MainWindow", "Ш"))
        self.comboBox.setItemText(26, _translate("MainWindow", "Щ"))
        self.comboBox.setItemText(27, _translate("MainWindow", "Ъ"))
        self.comboBox.setItemText(28, _translate("MainWindow", "Ы"))
        self.comboBox.setItemText(29, _translate("MainWindow", "Ь"))
        self.comboBox.setItemText(30, _translate("MainWindow", "Э"))
        self.comboBox.setItemText(31, _translate("MainWindow", "Ю"))
        self.comboBox.setItemText(32, _translate("MainWindow", "Я"))
        self.label.setText(_translate("MainWindow", "The last letter"))


if __name__ == "__main__":
    import sys
    app = QtWidgets.QApplication(sys.argv)
    MainWindow = QtWidgets.QMainWindow()
    ui = Ui_MainWindow()
    ui.setupUi(MainWindow)
    MainWindow.show()
    sys.exit(app.exec_())
